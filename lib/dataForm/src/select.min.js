"use strict";var _interopRequireDefault=require("E:/T/git/奥普Team/opu-components-vue/node_modules/@babel/runtime/helpers/interopRequireDefault");require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.find"),require("core-js/modules/es.array.find-index"),require("core-js/modules/es.array.index-of"),require("core-js/modules/es.array.map"),require("core-js/modules/es.number.constructor"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.regexp.to-string"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _toConsumableArray2=_interopRequireDefault(require("E:/T/git/奥普Team/opu-components-vue/node_modules/@babel/runtime/helpers/esm/toConsumableArray")),_objectSpread2=_interopRequireDefault(require("E:/T/git/奥普Team/opu-components-vue/node_modules/@babel/runtime/helpers/esm/objectSpread2")),_index=require("ant-design-vue/lib/select/index"),_utils=_interopRequireDefault(require("../../utils")),_conf=_interopRequireDefault(require("../conf"));function handleItemPropsOptions(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=t.vF,o=t.lF,i=t.childrenField;return e&&_utils.default.isArray(e)?_utils.default.clone(e).map(function(e){return n&&(e.value=e[n]+""),o&&(e.label=e[o]),r&&(e._pValue=r),e[i]&&e[i].length&&(e[i]=handleItemPropsOptions(e[i],t,e.value)),e}):e}var _default2={name:"OpuSelect",components:{},props:(0,_objectSpread2.default)((0,_objectSpread2.default)({},_index.SelectProps),{},{value:[Number,String,Object,Array],valueField:String,labelField:String,dataField:String,options:Array,searchFields:{type:Array,default:function(){return[]}},childrenField:String,renderOptionLabel:Function}),model:{prop:"value",event:"update"},data:function(){return{optionsData:[],hasGroup:!1}},computed:{vF:function(){return this.valueField?this.valueField:_conf.default.getSelectOptions.valueField},lF:function(){return this.labelField?this.labelField:_conf.default.getSelectOptions.labelField},componentProps:function(){var o=this,e=this.$listeners,t=this.$options,l=this.optionsData,r=this.value,p=this.searchFields,d=this.vF,c=this.lF,n=t.propsData,i={};_utils.default.each(e,function(e,n){i[n]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];o.$emit.apply(o,[n].concat(t))}});var a=r;r&&_utils.default.isNumber(r)?a=r+"":r&&_utils.default.isArray(r)&&(a=r.map(function(e){return e+""}));var u={props:(0,_objectSpread2.default)((0,_objectSpread2.default)({},n),{},{value:a}),on:(0,_objectSpread2.default)((0,_objectSpread2.default)({},i),{},{change:this.updateValue})};return u.props.showSearch&&!u.props.filterOption&&(u.props.filterOption=function(e,t){for(var r=t.componentOptions.propsData.value,n=l.findIndex(function(e){return e[d].toString()===r}),o=l[n],i=!1,a=[d,c].concat((0,_toConsumableArray2.default)(p)),u=0;u<a.length;u++){var s=a[u];if(o[s]&&0<=o[s].toString().toLowerCase().indexOf(e.toLowerCase())){i=!0;break}}return i}),u.props.options=l,u}},created:function(){this.init()},methods:{init:function(){var e=this.options;e&&e.length&&(this.optionsData=handleItemPropsOptions(e,this))},updateValue:function(t){var r=this.vF,e=this.optionsData,n=this.childrenField,o=_utils.default.treeTransArray(e,n),i=o.find(function(e){return e[r]==t}),a="";i&&i._pValue&&(a=o.find(function(e){return e[r]==i._pValue})),this.$emit("update",t,i,a),this.$emit("change",t,i,a)},setOptionsData:function(e){var t=handleItemPropsOptions(e,this);return this.optionsData=t},getOptionsData:function(){return this.optionsData},focus:function(){var e=this.$refs.inputComponent;e.focus();var t=e.$el.getElementsByClassName("ant-select-selection__rendered");t&&t.length&&t[0].click()},renderOptGroup:function(r){var n=this.childrenField,e=this.optionsData;return this.childrenField?e.map(function(e){var t="";return e[n]&&e[n].length?(t=e[n].map(function(e){return r("a-select-option",{props:{value:e.value}},[e.label])}),r("a-select-opt-group",{props:{label:e.label,key:e.value}},[t])):r("a-select-option",{props:{value:e.value}},[e.label])}):""},renderOptionItems:function(r){var e=this.optionsData,n=this.renderOptionLabel;return e.map(function(e){var t=n(e);return r("a-select-option",{props:{value:e.value}},[t])})}},render:function(e){var t=this.componentProps,r=this.renderOptGroup,n=this.renderOptionLabel,o=this.renderOptionItems,i=r(e),a="";return i?t.props.options=null:n&&_utils.default.isFunction(n)&&(a=o(e),t.props.options=null),e("a-select",{ref:"inputComponent",props:(0,_objectSpread2.default)({},t.props),on:(0,_objectSpread2.default)({},t.on)},[i,a])}};exports.default=_default2;