"use strict";var _interopRequireDefault=require("D:/OpenSource/OPU/opu-components-vue/node_modules/@babel/runtime/helpers/interopRequireDefault");require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.filter"),require("core-js/modules/es.array.find"),require("core-js/modules/es.array.index-of"),require("core-js/modules/es.array.map"),require("core-js/modules/es.number.constructor"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.regexp.to-string"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _toConsumableArray2=_interopRequireDefault(require("D:/OpenSource/OPU/opu-components-vue/node_modules/@babel/runtime/helpers/esm/toConsumableArray")),_objectSpread2=_interopRequireDefault(require("D:/OpenSource/OPU/opu-components-vue/node_modules/@babel/runtime/helpers/esm/objectSpread2")),_index=require("ant-design-vue/lib/select/index"),_utils=_interopRequireDefault(require("../../utils")),_conf=_interopRequireDefault(require("../conf"));function handleItemPropsOptions(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=t.vF,n=t.lF,i=t.childrenField;return e&&_utils.default.isArray(e)?_utils.default.clone(e).map(function(e){return o&&(e.value=e[o]+""),n&&(e.label=e[n]),r&&(e._pValue=r),e[i]&&e[i].length&&(e[i]=handleItemPropsOptions(e[i],t,e.value)),e}):e}var _default2={name:"OpuSelectGroup",components:{},props:(0,_objectSpread2.default)((0,_objectSpread2.default)({},_index.SelectProps),{},{value:[Number,String,Object,Array],valueField:String,labelField:String,dataField:String,options:Array,searchFields:{type:Array,default:function(){return[]}},childrenField:String}),model:{prop:"value",event:"update"},data:function(){return{optionsData:[],hasGroup:!1,cloneOptionsData:[]}},computed:{vF:function(){return this.valueField?this.valueField:_conf.default.getSelectOptions.valueField},lF:function(){return this.labelField?this.labelField:_conf.default.getSelectOptions.labelField},componentProps:function(){var n=this,e=this.$listeners,t=this.$options,r=this.optionsData,o=this.value,i=t.propsData,a={};_utils.default.each(e,function(e,o){a[o]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.$emit.apply(n,[o].concat(t))}});var s=o;o&&_utils.default.isNumber(o)?s=o+"":o&&_utils.default.isArray(o)&&(s=o.map(function(e){return e+""})),console.log(i);var l={props:(0,_objectSpread2.default)((0,_objectSpread2.default)({},i),{},{value:s}),on:(0,_objectSpread2.default)((0,_objectSpread2.default)({},a),{},{change:this.updateValue,search:this.onSearch})};return l.props.showSearch&&(l.props.filterOption=!1),l.props.options=r,l}},created:function(){this.init()},methods:{init:function(){var e=this.options;e&&e.length&&(this.optionsData=handleItemPropsOptions(e,this),this.cloneOptionsData=this.optionsData)},updateValue:function(t){var r=this.vF,e=this.optionsData,o=this.childrenField,n=_utils.default.treeTransArray(e,o),i=n.find(function(e){return e[r]==t}),a="";i&&i._pValue&&(a=n.find(function(e){return e[r]==i._pValue})),this.$emit("update",t,i,a),this.$emit("change",t,i,a)},setOptionsData:function(e){var t=handleItemPropsOptions(e,this);return this.optionsData=t,this.cloneOptionsData=this.optionsData,t},getOptionsData:function(){return this.optionsData},focus:function(){var e=this.$refs.inputComponent;e.focus();var t=e.$el.getElementsByClassName("ant-select-selection__rendered");t&&t.length&&t[0].click()},renderOptGroup:function(r){var o=this.childrenField,e=this.optionsData;return this.childrenField?e.map(function(e){var t="";return e[o]&&e[o].length?(t=e[o].map(function(e){return r("a-select-option",{props:{value:e.value}},[e.label])}),r("a-select-opt-group",{props:{label:e.label,key:e.value}},[t])):r("a-select-option",{props:{value:e.value}},[e.label])}):""},onSearch:function(e){var t=this.cloneOptionsData,r=this.vF,o=this.lF,n=this.searchFields,i=this.childrenField,a=_utils.default.clone(t,!0);if(e){var s=e.toLowerCase(),l=[r,o].concat((0,_toConsumableArray2.default)(n)),u=a.map(function(e){if(e[i]&&e[i].length){var t=e[i].filter(function(e){for(var t=!1,r=0;r<l.length;r++){var o=l[r];if(e[o]&&0<=e[o].toString().toLowerCase().indexOf(s)){t=!0;break}}return t});if(t&&t.length)return e[i]=t,e}for(var r=!1,o=0;o<l.length;o++){var n=l[o];if(e[n]&&0<=e[n].toString().toLowerCase().indexOf(s)){r=!0;break}}return r?e:""}).filter(function(e){return""!==e});this.optionsData=u}else this.optionsData=a}},render:function(e){var t=this.componentProps,r=(0,this.renderOptGroup)(e);return r&&(t.props.options=null),console.log(this.optionsData),e("a-select",{ref:"inputComponent",props:(0,_objectSpread2.default)({},t.props),on:(0,_objectSpread2.default)({},t.on)},[r])}};exports.default=_default2;