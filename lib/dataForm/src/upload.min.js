"use strict";var _interopRequireDefault=require("D:/demo/vue-npm-template/node_modules/@babel/runtime/helpers/interopRequireDefault");require("core-js/modules/es.array.map"),require("core-js/modules/es.function.name"),require("core-js/modules/es.number.constructor"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectSpread2=_interopRequireDefault(require("D:/demo/vue-npm-template/node_modules/@babel/runtime/helpers/esm/objectSpread2")),_defineProperty2=_interopRequireDefault(require("D:/demo/vue-npm-template/node_modules/@babel/runtime/helpers/esm/defineProperty")),_upload=_interopRequireDefault(require("ant-design-vue/lib/upload"));require("ant-design-vue/lib/upload/style/css");var _button=_interopRequireDefault(require("ant-design-vue/lib/button"));require("ant-design-vue/lib/button/style/css");var _message=_interopRequireDefault(require("ant-design-vue/lib/message"));require("ant-design-vue/lib/message/style/css");var _components,_utils=_interopRequireDefault(require("../../utils")),_default={name:"DataForm",components:(_components={},(0,_defineProperty2.default)(_components,_upload.default.name,_upload.default),(0,_defineProperty2.default)(_components,_button.default.name,_button.default),_components),props:{name:String,action:[String,Function],listType:String,headers:Object,accept:String,multiple:Boolean,showUploadList:[Boolean,Object],buttonText:[Function,String],value:[Object,String,Array],fileList:[Array],method:String,directory:Boolean,beforeUpload:Function,customRequest:Function,data:[Object,Function],disabled:Boolean,previewFile:Function,supportServerRender:Boolean,withCredentials:Boolean,openFileDialogOnClick:Boolean,remove:Function,transformFile:Function,responseUrlField:{type:String,default:"data.url"},maxSize:Number},model:{prop:"value",event:"update"},data:function(){return{}},methods:{onBeforeUpload:function(e){return this.beforeUpload?this.beforeUpload(e):this.hasAccept(e,!0)},onChange:function(e){this.$emit("update",e),this.$emit("change",e)},onPreview:function(e){var t="";e.url?t=e.url:e.response&&(t=_utils.default.getObjData(this.responseUrlField,e.response)),this.$listeners.preview||window.open(t,"new")},hasAccept:function(e,t){if(e.size>this.maxSize){var r=Math.floor(this.maxSize/1024);return t&&_message.default.error("附件限制大小为：".concat(r,"KB")),!1}return!0}},render:function(e){var t=this.multiple,r=this.listType,n=this.buttonText,o=this.value,i=this.onChange,a=this.onPreview,u=this.onBeforeUpload,s=this.$options.propsData,l=this.$listeners,p="上传文件";n&&"function"==typeof n?p=n():n&&(p=n);var d="";if(d="picture-card"===r?e("span",{class:"upload-image-button"},p):e("a-button",{props:{icon:"upload"}},p),o&&"string"==typeof o){if(t)throw new Error("When multiple selection mode, the value should be an Array");s.fileList=[{uid:"-1",name:"image",status:"done",url:o}]}else o&&o.length?s.fileList=o.map(function(e,t){return"string"==typeof e?{uid:"-".concat(t),name:"image",status:"done",url:e}:e}):o&&o.fileList&&(s.fileList=o.fileList.map(function(e){return e.status||(e.status="error"),e}));return s.fileList&&s.fileList.length&&!this.multiple&&(d=""),e("a-upload",{props:(0,_objectSpread2.default)((0,_objectSpread2.default)({},s),{},{beforeUpload:u}),on:(0,_objectSpread2.default)((0,_objectSpread2.default)({},l),{},{change:i,preview:a})},[d])}};exports.default=_default;