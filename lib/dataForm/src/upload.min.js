"use strict";var _interopRequireDefault=require("D:/OpenSource/OPU/opu-components-vue/node_modules/@babel/runtime/helpers/interopRequireDefault");require("core-js/modules/es.array.map"),require("core-js/modules/es.number.constructor"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectSpread2=_interopRequireDefault(require("D:/OpenSource/OPU/opu-components-vue/node_modules/@babel/runtime/helpers/esm/objectSpread2")),_utils=_interopRequireDefault(require("../../utils")),_default={name:"DataForm",components:{},props:{name:String,action:[String,Function],listType:String,headers:Object,accept:String,multiple:Boolean,showUploadList:[Boolean,Object],buttonText:[Function,String],value:[Object,String,Array],fileList:[Array],method:String,directory:Boolean,beforeUpload:Function,customRequest:Function,data:[Object,Function],disabled:Boolean,previewFile:Function,supportServerRender:Boolean,withCredentials:Boolean,openFileDialogOnClick:Boolean,remove:Function,transformFile:Function,responseUrlField:{type:String,default:"data.url"},maxSize:Number,dragger:Boolean},model:{prop:"value",event:"update"},data:function(){return{}},methods:{onBeforeUpload:function(e){return this.beforeUpload?this.beforeUpload(e):this.hasAccept(e,!0)},onChange:function(e){this.$emit("update",e),this.$emit("change",e)},onPreview:function(e){var t="";e.url?t=e.url:e.response&&(t=_utils.default.getObjData(this.responseUrlField,e.response)),this.$listeners.preview||window.open(t,"new")},hasAccept:function(e,t){if(e.size>this.maxSize){var o=Math.floor(this.maxSize/1024);return t&&this.$message.error("附件限制大小为：".concat(o,"KB")),!1}return!0}},render:function(e){var t=this.multiple,o=this.listType,r=this.buttonText,i=this.value,n=this.onChange,a=this.onPreview,s=this.onBeforeUpload,u=this.dragger,l=this.$options.propsData,p=this.$listeners,d="上传文件";r&&_utils.default.isFunction(r)?(d=[r()],console.log(d)):r&&(d=r);var c="";if(c="picture-card"===o?e("span",{class:"upload-image-button"},d):e("a-button",{props:{icon:"upload"}},d),i&&"string"==typeof i){if(t)throw new Error("When multiple selection mode, the value should be an Array");l.fileList=[{uid:"-1",name:"image",status:"done",url:i}]}else i&&i.length?l.fileList=i.map(function(e,t){return"string"==typeof e?{uid:"-".concat(t),name:"image",status:"done",url:e}:e}):i&&i.fileList&&(l.fileList=i.fileList.map(function(e){return e.status||(e.status="error"),e}));return l.fileList&&l.fileList.length&&!this.multiple&&(c=""),e(!0===u?"a-upload-dragger":"a-upload",{props:(0,_objectSpread2.default)((0,_objectSpread2.default)({},l),{},{beforeUpload:s}),on:(0,_objectSpread2.default)((0,_objectSpread2.default)({},p),{},{change:n,preview:a})},[c])}};exports.default=_default;