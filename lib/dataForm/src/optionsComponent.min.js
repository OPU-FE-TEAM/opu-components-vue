"use strict";var _interopRequireDefault=require("D:/OpenSource/OPU/opu-components-vue/node_modules/@babel/runtime/helpers/interopRequireDefault");require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.map"),require("core-js/modules/es.number.constructor"),Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectSpread2=_interopRequireDefault(require("D:/OpenSource/OPU/opu-components-vue/node_modules/@babel/runtime/helpers/esm/objectSpread2")),_utils=_interopRequireDefault(require("../../utils")),_conf=_interopRequireDefault(require("../conf"));function handleItemPropsOptions(e,t,a){var i=t||_conf.default.getSelectOptions.valueField,n=a||_conf.default.getSelectOptions.labelField;return e&&_utils.default.isArray(e)?_utils.default.clone(e).map(function(e){return i&&(e.value=e[i]),n&&(e.label=e[n]),e.children&&e.children.length&&(e.children=handleItemPropsOptions(e.children,i,n)),e}):e}var _default2={name:"optionsComponent",components:{},props:{renderName:{type:String,default:"a-input"},api:Function,param:{type:Object,default:function(){}},value:[Number,String,Object,Array],valueField:String,labelField:String,dataField:String,options:Array},model:{prop:"value",event:"update"},data:function(){return{optionsData:[]}},computed:{componentProps:function(){var n=this,e=this.$listeners,t=this.$options,a=this.optionsData,i=this.renderName,o=t.propsData,r={};_utils.default.each(e,function(e,i){r[i]=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];n.$emit.apply(n,[i].concat(t))}});var u={props:(0,_objectSpread2.default)({},o),on:(0,_objectSpread2.default)((0,_objectSpread2.default)({},r),{},{change:this.updateValue})};return"a-tree-select"===i?u.props.treeData=a:u.props.options=a,u}},watch:{api:function(){this.init()},param:function(){this.init()}},created:function(){this.init()},methods:{init:function(){var e=this.api,t=this.param,a=this.valueField,i=this.labelField,n=this.fetchOptionsData,o=this.options;e||t?n():o&&o.length&&(this.optionsData=handleItemPropsOptions(o,a,i))},updateValue:function(e){this.$emit("update",e),this.$emit("change",e)},fetchOptionsData:function(){var i=this,n=this.dataField,o=this.valueField,r=this.labelField,e=this.param,t=this.api;(t||_conf.default.getSelectOptions.api)(e).then(function(e){var t=n||_conf.default.getSelectOptions.dataField,a=handleItemPropsOptions(_utils.default.getObjData(t,e),o,r);i.optionsData=a})},setOptionsData:function(e){this.optionsData=e}},render:function(e){var t=this.renderName,a=this.componentProps;return e(t,{props:(0,_objectSpread2.default)({},a.props),on:(0,_objectSpread2.default)({},a.on)},[])}};exports.default=_default2;